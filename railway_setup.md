# Настройка Railway для сохранения данных

При деплое на Railway данные из директории `data/` могут теряться при перезапуске контейнера, так как Railway не сохраняет состояние файловой системы между деплоями.

## Важно: Автоматическая инициализация

Бот автоматически создаст все необходимые файлы при первом запуске:
- `default_schedule.txt` - расписание по умолчанию
- `admins.txt` - список администраторов из `config.py`
- Пустые файлы `employees.txt`, `pending_employees.txt`
- Все необходимые директории

**Но данные о сотрудниках и расписаниях будут теряться при каждом деплое!**

## Решения для сохранения данных

### Способ 1: Railway PostgreSQL (Рекомендуется)

Использование базы данных PostgreSQL для хранения данных:

1. В панели Railway откройте ваш проект
2. Нажмите **+ New** → **Database** → **Add PostgreSQL**
3. Railway автоматически создаст базу данных и добавит переменную окружения `DATABASE_URL`
4. Обновите код для использования PostgreSQL вместо файлов

**Примечание:** Это требует миграции кода на использование базы данных вместо файлов.

### Способ 2: Внешнее хранилище (S3, Google Cloud Storage)

Использование облачного хранилища для файлов:

1. Создайте bucket в S3 или Google Cloud Storage
2. Добавьте переменные окружения с credentials
3. Обновите код для сохранения/загрузки файлов из облака

### Способ 3: Принять потерю данных при деплое

Если данные не критичны или их можно быстро восстановить:

- Бот автоматически создаст все файлы при первом запуске
- Администраторы могут быстро добавить сотрудников через команды бота
- Расписания можно восстановить через команды `/set_week_days`

**Для этого способа:**
1. Убедитесь, что в `config.py` указаны правильные `ADMIN_IDS`
2. После каждого деплоя используйте `/admin_add_employee` для добавления сотрудников
3. Используйте `/set_week_days` для восстановления расписаний

### Способ 4: Резервное копирование перед деплоем

Перед каждым деплоем делайте резервную копию данных:

1. Скачайте файлы из `data/` через Railway CLI:
   ```bash
   railway run cat data/employees.txt > employees_backup.txt
   ```
2. После деплоя восстановите данные вручную или через скрипт

## Переменные окружения

Убедитесь, что в Railway настроены переменные окружения:

1. В панели Railway откройте ваш проект
2. Перейдите в раздел **Variables**
3. Добавьте:
   - `BOT_TOKEN` - токен бота (если не используется из `config.py`)
   - `ADMIN_IDS` - ID администраторов через запятую (если не используется из `config.py`)

## Рекомендация

Для продакшена рекомендуется использовать **Способ 1 (PostgreSQL)** или **Способ 2 (Внешнее хранилище)**. Для тестирования или если данные не критичны, можно использовать **Способ 3**.

